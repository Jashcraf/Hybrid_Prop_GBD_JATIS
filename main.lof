\contentsline {figure}{\numberline {1}{\ignorespaces Modeling flow inspired by the Structural Thermal Optical Performance (STOP) modeling process for the Roman Coronagraph \cite {Krist18}. This diagram illustrates the different modeling regimes required to create a simulated image of an observatory. We aim to further integrate this modeling pipeline by creating an open-source Gaussian Beamlet Decomposition platform to unify the ray trace model of the observatory with the diffraction model of the coronagraph.}}{6}{figure.1}%
\contentsline {figure}{\numberline {2}{\ignorespaces \added {Illustration of the operating principle of GBD in one dimension. The aperture function for traditional imaging systems is shown in (a) as a top-hat function of uniform amplitude. The decomposition of this function into a discrete set of Gaussian beams is shown in (b), which shows nine evenly-spaced Gaussian profiles before their coherent summation, which is shown in (c). The coherent sum (black) of these nine beamlets shows that the beamlets are incapable of perfectly reconstructing the original aperture function (dashed red), specifically the sharp edge and uniform amplitude. More beamlets are needed for a more accurate reconstruction, which is shown in (d) for 199 beamlets. The amplitude ripple has virtually vanished, and the field near the aperture edges is almost entirely recovered.}}}{8}{figure.2}%
\contentsline {figure}{\numberline {3}{\ignorespaces Diagram demonstrating the hybrid propagation physics model. The observatory optics are best described by a ray-based propagation model, so GBD is used to compute the field at the image plane before the coronagraph focal plane mask (FPM). The field array is then passed to a paraxial diffraction model which propagates it past the FPM and through the remainder of the coronagraph. This propagation scheme permits the user to model the influence of the observatory optics non-paraxially, without losing accuracy after propagating past the focal plane mask.}}{12}{figure.3}%
\contentsline {figure}{\numberline {4}{\ignorespaces \added {Illustration of Poke's use as an interface to open-source ray-based physical optics. Poke only requires an interface between a ray tracing engine (orange, left) to generate and save a Rayfront object, which includes all ray data necessary for the GBD calculation. Currently, Poke supports sequential systems in CODE V and Zemax, but we are working on adding support for open-source packages that have ray tracers, like ray-optics\cite {rayoptics}. The GBD field that Poke computes can then be sent to any open-source diffraction modeling package (yellow, right) to complete the hybrid propagation model.}}}{13}{figure.4}%
\contentsline {figure}{\numberline {5}{\ignorespaces Diagram illustrating differential ray tracing in the 2D case for a simple lens system. The central ray (black) is propagated along with two parabasal rays with a differential addition in the $y$ direction (red) and another with a differential addition in the $l$ direction (blue). To determine the ABCD matrix the ray data is computed on the transversal plane, which is normal to the central ray.}}{20}{figure.5}%
\contentsline {figure}{\numberline {6}{\ignorespaces Illustration of the Even (left), Fibonacci (middle), and Polar (right) sample schemes for decomposing the field at the entrance pupil of the optical system with approximately the same number of beamlets in each figure. Quantifying the ramifications of these sample schemes is of paramount importance to accurate diffraction simulation.}}{24}{figure.6}%
\contentsline {figure}{\numberline {7}{\ignorespaces Illustration of the concept for transfer-matrix Gaussian beamlet decomposition. The principle is to propagate the central ray that emanates normal to the peak of the Gaussian beam (red) in the entrance pupil to the transversal plane that intersects a given point on a detector (yellow pixel). The Gaussian field is evaluated at this intersection, and the process is repeated for each pixel and each ray. The coherent superposition of the Gaussian beams yields the field observed on the detector.}}{25}{figure.7}%
\contentsline {figure}{\numberline {8}{\ignorespaces \added {Illustration of relevant ray parameters necessary to propagate the ray data to the transversal plane, where we evaluate the Gaussian field that intersects with a detector pixel. A ray that defines a Gaussian beam is placed on the source plane (leftmost vertical dashed line) with some direction ($\mathbf {k}_{ray,S}$) and position ($\mathbf {r}_{ray,S}$) and propagated though the system. At the detector plane (rightmost vertical dashed line), the ray's direction and positions ($\mathbf {k}_{ray,D}$ and $\mathbf {r}_{ray,D}$ respectively) have been transformed by the optical system. To propagate the rays to the transversal plane (tilted dashed line) that intersects the pixel at $\mathbf {r}_{pixel,D}$ where the field evaluation occurs, it must be moved a distance $\Delta _{ray}$ along the ray path in detector space.}}}{26}{figure.8}%
\contentsline {figure}{\numberline {9}{\ignorespaces Caption}}{29}{figure.9}%
\contentsline {figure}{\numberline {10}{\ignorespaces Example of the five rays position coordinates on the transversal plane after propagating through a rotationally symmetric optical system. The rotational symmetry means the rays stay in their plane of incidence, in this case, the +m and +y rays stay in the $y-z$ plane, and the +l and +x rays stay in the $x-z$ plane. Along the vertical $y_{T}$ axis, the $+m$ and $+y$ ray positions are shown in red and purple, respectively. Along the horizontal $x_{T}$ axis, the $+l$ and $+x$ rays are shown in blue and green, respectively. The central ray coordinate acts as the coordinate origin of the transversal plane, given by $\mathbf {r}_{cen,T}$. The light blue region that inscribes the position vectors is the area that is represented by the differential ray trace, and is effectively what we enforce the paraxial approximation over.}}{32}{figure.10}%
\contentsline {figure}{\numberline {11}{\ignorespaces \added {Illustration of the hybrid propagation physics model used to produce the results in this section. The system perscription in table \ref {tab:fiducial_observatory_specs} is loaded into Zemax OpticStudio and shown on the left (labeled HST). The phase of the vector vortex coronagraph (VVC) is shown in the middle. The GBD PSF is computed at this plane and propagated through the coronagraph using HCIPy to arrive at the final image at the detector plane.}}}{35}{figure.11}%
\contentsline {figure}{\numberline {12}{\ignorespaces Comparisons of the PSF (top) and MTF (middle) for GBD with even sampling (left) and analytical Airy pattern (middle). The PSFs are given in units of normalized intensity, such that the sum of the energy in the PSF is unity. The fractional difference is plotted on the right, and the azimuthally averaged radial profile is plotted on the bottom. The MTF is plotted out to the cutoff frequency of the HST of around 25 cy/mm. The radial oscillation in \added {the} fractional difference PSF is indicative of the artifacts introduced by GBD. In the MTF it is apparent that frequencies below 20 cy/mm are well-maintained, but the higher spatial frequencies increase in fractional difference. The effect on the PSF is revealed in the radial profile, where the PSF appears to spread out at larger angular separations. The RMS difference of the PSF data is 2.3e-6.}}{38}{figure.12}%
\contentsline {figure}{\numberline {13}{\ignorespaces Comparisons of the PSF (top) and MTF (middle) for GBD with Fibonacci sampling for the same number of beamlets as figure \ref {fig:airy_even} (left) and analytical airy pattern (middle). The PSFs are given in units of normalized intensity, such that the sum of the energy in the PSF is unity. The fractional difference is plotted on the right, with the MTF plotted out to the cutoff frequency of the HST of around 25 cy/mm. The azimuthally averaged radial profile is plotted on the bottom. The fractional difference PSF is noticeably free of the ripples present in Figure \ref {fig:airy_even}, and the fractional difference MTF shows that frequencies out to 23 cy/mm are well-maintained. The spreading present in Figure \ref {fig:airy_even} is noticeably absent in the radial profile. The RMS difference of the PSF data is 1.6e-6, indicating that this distribution results in a more accurate simulation.}}{39}{figure.13}%
\contentsline {figure}{\numberline {14}{\ignorespaces The RMS difference between the sum-normalized GBD PSF and analytical Airy function for the Fibonacci (blue circles) and Even (black squares) sample schemes. For the circular aperture it is clear that the Fibonacci sample scheme is more accurate for every case given a circular aperture. However, the returns are diminishing as the number of beamlets increases.}}{40}{figure.14}%
\contentsline {figure}{\numberline {15}{\ignorespaces \added {Simulations of an aberrated PSF with secondary support structure in the entrance pupil of our HST model given in Table \ref {tab:fiducial_observatory_specs}. The GBD PSF (left) and Zemax Huygens PSF (right) have very similar structure, with the dominant difference in structure being the features from the sharp-edge diffraction from the spiders (shown in fractional difference on the right). This simulation helps quantify the degree to which GBD's difficulty in modeling sharp-edge diffraction effects. The RMS difference of the PSF data is 7.5e-6.}}}{41}{figure.15}%
\contentsline {figure}{\numberline {16}{\ignorespaces Comparison of the Coronagraphic PSF \added {from 3-30 $\lambda / D$} generated by a solely Fraunhofer diffraction model (a) and the proposed Hybrid propagation scheme for a varying number of beamlets across the 2.4m \replaced {HST}{hubble} aperture with an overlap factor of \replaced {2}{1.7}. (b) was generated with 200 beamlets, (c) with 300 beamlets, (d) with 400 beamlets, \added {(e) with 500 beamlets, and (f) with 600 beamlets across the aperture}. These data were generated by producing a PSF with the given propagation scheme and then propagating it through HCIPy's VortexCoronagraph class with a topological charge of \replaced {2}{6}. To reflect the residual starlight's astrophysical flux ratio ``contrast", the PSF data are normalized to the maximum of an off-axis PSF at \replaced {$\approx 16 \lambda /D$}{$\approx 25 \lambda /D$} that propagates through the VortexCoronagraph. The mean contrast of the masked region (C) is shown on each image. The residuals \replaced {from the Hybrid propagation (b-f) are brighter than the equivalent Fraunhofer simulation, and minimize at the 500 beamlet case. This is particularly apparent near the inner working angle, where we see a signal of $\approx $ $1 \times 10^-8$ for the 200 beamlet case decrease to $\approx 5 \times 10^{-9}$ in the 500 beamlet case. }{from the Fibonacci distribution are clearly visible as high-frequency rings in b-d, which are at greater than earthlike exoplanet ($10^{-10}$) contrast. However, it is encouraging that with more beamlets the prominent circles shown in (b) become around the same level as the background in (d).} This is indicative of GBD's ability to be further improved with \deleted {more computational resources or} a more judicious choice of beamlets.}}{43}{figure.16}%
\contentsline {figure}{\numberline {17}{\ignorespaces Run time comparison for a 50x50 grid of Gaussian beamlets on a 256 x 256 detector grid v.s. number of CPU cores used. Numexpr considerably accelerates the exponential calculation given multiple processing cores, and is an encouraging path forward for further parallelization.}}{50}{figure.17}%
